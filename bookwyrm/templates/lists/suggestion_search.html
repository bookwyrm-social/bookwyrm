{% load i18n %}
{% load utilities %}
{% load group_tags %}

<form name="search" action="{{ search_url }}" method="GET" class="block">
    <div class="field has-addons">
        <div class="control">
            <input aria-label="{% trans 'Search for a book' %}" class="input" type="text" name="{{ query_param }}" placeholder="{% trans 'Search for a book' %}" value="{{ query }}" spellcheck="false">
        </div>
        <div class="control">
            <button class="button" type="submit">
                <span class="icon icon-search" title="{% trans 'Search' %}">
                    <span class="is-sr-only">{% trans "search" %}</span>
                </span>
            </button>
        </div>
    </div>
    {% if query %}
    <p class="help"><a href="{{ search_url }}">{% trans "Clear search" %}</a></p>
    {% endif %}
</form>
{% if not suggested_books %}
{% if query %}
<p>{% blocktrans %}No books found matching the query "{{ query }}"{% endblocktrans %}</p>{% else %}
<p>{% trans "No books found" %}</p>
{% endif %}
{% endif %}

{% if suggested_books|length > 0 %}
<div{% if columns %} class="columns is-multiline"{% endif %}>
    {% for book in suggested_books %}
    <div class="block {% if columns %}column is-5 m-0{% endif %}">
        <div class="columns is-mobile is-gapless">
            <a
                class="column is-2-mobile is-3-tablet is-cover align to-c"
                href="{{ book.local_path }}"
                aria-hidden="true"
            >
                {% include 'snippets/book_cover.html' with book=book cover_class='is-w-auto is-h-s-mobile align to-t' size='small' %}
            </a>

            <div class="column ml-3 control">
                <p>{% include 'snippets/book_titleby.html' with book=book %}</p>

                {% join "add_item" list.id book.id as modal_id %}
                <button
                    type="button"
                    class="button is-small is-link"
                    data-modal-open="{{ modal_id }}"
                >
                    {% if is_suggestion or list.curation == 'open' or request.user == list.user or list.group|is_member:request.user %}
                        {% trans "Add" %}
                    {% else %}
                        {% trans "Suggest" %}
                    {% endif %}
                </button>
                {% include "lists/add_item_modal.html" with id=modal_id is_suggestion=is_suggestion list=list %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

