{% load i18n %}
{% load utilities %}

{% if request.user.is_authenticated %}
{% with book.suggestion_list as list %}
    <h2 class="title is-5">
        {% trans "Add suggestions" %}
    </h2>
    <form name="search" action="{% url 'book' book_id=book.id %}#suggestions-section" method="GET" class="block">
        <div class="field has-addons">
            <div class="control">
                <input aria-label="{% trans 'Search for a book' %}" class="input" type="text" name="suggestion_query" placeholder="{% trans 'Search for a book' %}" value="{{ query }}">
            </div>
            <div class="control">
                <button class="button" type="submit">
                    <span class="icon icon-search" title="{% trans 'Search' %}">
                        <span class="is-sr-only">{% trans "search" %}</span>
                    </span>
                </button>
            </div>
        </div>
        {% if query %}
        <p class="help"><a href="{% url 'book' book_id=book.id %}#suggestions-section">{% trans "Clear search" %}</a></p>
        {% endif %}
    </form>
    {% if not suggested_books %}
    {% if query %}
    <p>{% blocktrans %}No books found matching the query "{{ query }}"{% endblocktrans %}</p>{% else %}
    <p>{% trans "No books found" %}</p>
    {% endif %}
    {% endif %}

    {% if suggested_books|length > 0 %}
        {% for book in suggested_books %}
            <div class="columns is-mobile is-gapless">
                <div class="column ml-3">
                    <p>{% include 'snippets/book_titleby.html' with book=book %}</p>

                    {% join "add_item" list.id book.id as modal_id %}
                    <button
                        type="button"
                        class="button is-small is-link"
                        data-modal-open="{{ modal_id }}"
                    >
                        {% trans "Add" %}
                    </button>
                    {% include "lists/add_item_modal.html" with id=modal_id is_suggestion=True %}
                </div>
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}
{% endif %}

